# TRH9000 and TRH9000S
Yamaha V9990 based open-source video cards for the MSX

## Introduction

If you ever spent just a few minutes on YouTube searching for MSX content, I bet you certainly found some footage covering the V9990. Well, not specifically the V9990 chip, but video cards based on it.

The first video card based on the unreleased, kind of obscure Yamaha V9990 VDP chip was the Graphics9000 (or GFX9000). The GFX9000 is (was) an MSX standard graphics expansion device for home computers developed by Sunrise in 1994.

It was designed as an expansion cartridge for the MSX standard that can be installed in a slot on a computer that also connects to the computer’s video output and monitor. The device works as an additional independent video controller.

The device is based on the Yamaha V9990 video controller (VDP). The chip was based on the never-produced V9978 chip, designed specifically for use in computers of the alleged but not implemented (by the time of this writing) MSX3 standard. Compared to the V9978, the V9990 is not backward compatible with the V99x8 chips, and thus cannot be used as the main video controller of standard MSX-compatible computers.

## The TRH9000 and the TRH9000S

TRH9000 is the name of a brand new open-source implementation of the GFX9000. It is a community effort to create everything required to build MSX cartridges capable to run V9990 software.

[TRH9000](images/TRH9000.jpg)

TRH9000S has the same features of the simpler TRH9000 plus the capability to superimpose the image from the MSX computer where it is connected to the image generated by the V9990 VDP (using a cable connected to an input RGB connector on the cartridge).

[TRH9000S](images/TRH9000S_0.jpg)

The goal is to make the card more accessible and improve the amount of software available for it. 

## Kudos

There are a few folks activelly helping with the project and I would like to call them out here:

* Alexandre Souza
* Doomn00b
* Darlei Duarte
* lintweaker
* Luciano Sturaro
* sdsnatcher73
* Thiago Valença

## Development Log 

* 8/10/2022 - Routing day 1. Decided to move from TSOP-II-40 to SOJ-40 as the pins in the first encapsulation are more difficult to connect/route to the V9990. Using 0.21 tracks to optimize routing. Will provide the RGB connector (standard) and a pin header with the SVGA signal. Updating the forums and rest of stakeholders. First image status uploaded. 
* 8/8/2022 - Initial component placement on the PCB. Still lot of work to do in order to improve routing. 
* 8/4/2022 - Reviewed the footprints in preparation to start creating the first PCB draft. Had to create a custom TSOP-2-40 footprint as I could't find any on the net. Using 0805 for the resistors and ceramic capacitors. THT electrolytics. Reviewing the list of pending questions to get everything ready for the PCB creation. (REV0)
* 8/2/2022 - I just finished the first (rev0) draft of the schematics and I'll run it through more experienced MSX hardware developers. Please, if you feel you have something to add, clone the repo and contribute. You can also reach out if you want to suggest something. You can see a PDF with the first draft [here](Docs/TRH9000_Schema_Revision_0.pdf). Kicad files are stored on the [hardware/kicad](hardware/Kicad/) folder. (REV0)
* 8/15/2022 - Merged changes proposed by Doomn00b. 
* 8/20/2022 - Routing. Almost finished routing for the VDP. Moved back the footprint for the 14mhz oscillator to THT as it is easier to find outside US/Europe and I have a bunch laying around here. Organized all components into the PCB. Removed the holed in the cartridge so I can better measure them in the standard MSX cartridge. Changed the RGB connector footprint to a shorter version so we can fit it in the standard size cartridge. Fixed multiple footprints to 0805 as we will be standardizing in that size. 
* 8/21/2022 - Routing for rev 1 is done. Pending prototyping and possible fixes to the main circuit/pcb before first test batch. Waiting for review of others.
* 9/10/2022 - Publishing the files for the prototype test board being used during development. Fixing the symbols for the KM428C256 memory chip on the schema. The initial configuration had a few pins wrongly assigned as it was based on the ZIP package instead of the SOJ package we are planning to use. Included additional datasheets being analyzed and updated README files to describe files being uploaded to the repo.
* 9/21/2022 - Upload of a prototype image to the images repository. BUSDIR implementation/fix. Initial analysis to implement superimpose circuit and additional connector to collect the MSX video signal. Adjusts on the main circuit after initial tests with the prototype. PDF printed version update of the latest version of the circuit for contributors review. 
* 10/2/2022 - Multiple fixes after testing with the prototype and the logic analyzer. Prototype managed to generate video for the first time but quality is not good (expected for a prototype with floating wires). Fixes to the VDP selection logic. Adjusts to the power diagrams to be more clear on pins being used for GND and the multiple VCC lines. Extension of the board to host the two connectors in preparation for the superimpose circuit. First test batch ordered. Uploaded datasheets for the RGB multiplexer (LT1675) and voltage converter (ICL7660) to generate -5V for the mux. 
* 10/31/2022 - Fixes after running the first test batch. Moving the 138 and 32 ICs to different positions to avoid issues with the cartridge box. Equalizing footprints for capacitors. Changing C23 to electrolytic. When using SOJ40 sockets the plastic was passing the edge of the PCB. Adjusts on the selection logic. Change on the memory chip symbol as the datasheet seems to be incorrect on PIN13. Following tips from contributors and fixing pins 12 and 13 on the memory ICs. Rerouting after changes and focusing on a simple version without superimposing. After testing will create another branch to support a version with superimpose. Generating interactive BOM.  
* 11/27/2022 - Documented multiple findings, test results, changes to the PCB and the split between TRH9000 and TRH9000S. Publishing the v1.0 release of the TRH9000 already function and with reasonable video quality. TRH9000S is still being tested but already working with superimpose in the Omega MSX. Changes to the edge cuts to fit both boards into the standard MSX cartridge box. Replacement of the standard capacitors by tantalum. Changes to improve video quality.   
## License 

This work is licensed under the CERN OHL-S v2. You may redistribute and modify this project and its documentation under the terms of the CERN-OHL-S v2.

![Open Hardware](https://raw.githubusercontent.com/cristianoag/trh9000/main/Images/1024px-Open-source-hardware-logo.svg.png)

